local player = game.Players.LocalPlayer
local maxDistance = 10000000  -- 10 million studs

-- Create a ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Create a Frame for the GUI
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 150)
frame.Position = UDim2.new(0.5, -150, 0.5, -75)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Parent = screenGui

-- Add a UIGradient for the purple gradient
local uiGradient = Instance.new("UIGradient")
uiGradient.Parent = frame
uiGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(85, 0, 127)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(127, 0, 255))
}

-- Create a TextButton
local button = Instance.new("TextButton")
button.Size = UDim2.new(1, 0, 0, 50)
button.Position = UDim2.new(0, 0, 0.5, -25)
button.Text = "Speed Up Carts"
button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
button.BorderSizePixel = 0
button.Parent = frame

-- Make the button rounded
local function roundButton(button)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = button
end
roundButton(button)

-- Function to allow dragging of the frame
local dragging = false
local dragInput, startPos

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        startPos = input.Position - frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        frame.Position = UDim2.new(0, input.Position.X - startPos.X, 0, input.Position.Y - startPos.Y)
    end
end)

-- Speed Up Function
local function speedUpAllCarts()
    for _, cart in pairs(workspace:GetDescendants()) do
        if cart.Name == "Up" and cart:FindFirstChild("Click") then
            local distance = (cart.Position - player.Character.HumanoidRootPart.Position).magnitude
            if distance <= maxDistance then
                fireclickdetector(cart.Click)  -- Fires the click detector to speed up the cart
            end
        end
    end
    
    button.Text = "Speed Up Again"  -- Change button text after use
end

-- Connect the button click to the function
button.MouseButton1Click:Connect(speedUpAllCarts)
